<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Import Vega & Vega-Lite (does not have to be from CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@4"></script>
  <!-- Import vega-embed -->
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>
<body>
    <p>Demo Charts</p>
<div style="width:95%; height:25vmin;" id="summary_obesityP"></div>
<div style="width:95%; height:25vmin;" id="summary_bikeLanP"></div>
<div style="width:95%; height:25vmin;" id="summary_nabSafeP"></div>
<div style="width:95%; height:25vmin;" id="summary_parkDisP"></div>
<div style="width:95%; height:25vmin;" id="summary_poveACSP"></div>
<div style="width:95%; height:25vmin;" id="summary_preMorAA"></div>
<div style="width:95%; height:25vmin;" id="summary_ratRepoP"></div>
<div style="width:95%; height:25vmin;" id="summary_recBikeP"></div>
<div style="width:95%; height:25vmin;" id="summary_recExerP"></div>
<div style="width:95%; height:25vmin;" id="summary_sidwalkP"></div>
<div style="width:95%; height:25vmin;" id="summary_subDistP"></div>
<div style="width:95%; height:25vmin;" id="summary_treeCovP"></div>


<script type="text/javascript">

  var NeighborhoodName = "Canarsie - Flatlands"; //change this to alter the highlighted neighborhood 
  var summarySpec = {
    "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
    "width": "container",
    "height": "container",
    "autosize": "fit",
    "data": {"url": "visualizations/csv/bikeLanP.csv"},
    "mark": {"type": "bar", "tooltip": true},
    "encoding": {
      "x": {
        "field": "Neighborhood",
        "type": "nominal",
        "sort": {"op": "mean", "field": "Data Value"},
        "axis":null
      },
      "y": {
        "field": "Data Value",
        "type": "quantitative",
        "axis": {"title":null}
      },
      "color": {
          "condition": {
              "test": "datum.Neighborhood=='Canarsie - Flatlands'",
              "value": "orange"
          },
          "value": "gray"
      }
    }
  }
  ; //this is the template vega-lite json (a copy is in the visualizations/json folder as summary.vl.json)
  
  const indicatorDataPath = "visualizations/csv/"; //change this to alter the path to the data file

  vegaEmbed("#summary_bikeLanP", buildSummarySpec(NeighborhoodName,summarySpec,"bikeLanP")).then().catch(console.error);
  vegaEmbed("#summary_nabSafeP", buildSummarySpec(NeighborhoodName,summarySpec,"nabSafeP")).then().catch(console.error);
  vegaEmbed("#summary_obesityP", buildSummarySpec(NeighborhoodName,summarySpec,"obesityP")).then().catch(console.error);
  vegaEmbed("#summary_parkDisP", buildSummarySpec(NeighborhoodName,summarySpec,"parkDisP")).then().catch(console.error);
  vegaEmbed("#summary_poveACSP", buildSummarySpec(NeighborhoodName,summarySpec,"poveACSP")).then().catch(console.error);
  vegaEmbed("#summary_preMorAA", buildSummarySpec(NeighborhoodName,summarySpec,"preMorAA")).then().catch(console.error);
  vegaEmbed("#summary_ratRepoP", buildSummarySpec(NeighborhoodName,summarySpec,"ratRepoP")).then().catch(console.error);
  vegaEmbed("#summary_recBikeP", buildSummarySpec(NeighborhoodName,summarySpec,"recBikeP")).then().catch(console.error);
  vegaEmbed("#summary_recExerP", buildSummarySpec(NeighborhoodName,summarySpec,"recExerP")).then().catch(console.error);
  vegaEmbed("#summary_sidwalkP", buildSummarySpec(NeighborhoodName,summarySpec,"sidwalkP")).then().catch(console.error);
  vegaEmbed("#summary_subDistP", buildSummarySpec(NeighborhoodName,summarySpec,"subDistP")).then().catch(console.error);
  vegaEmbed("#summary_treeCovP", buildSummarySpec(NeighborhoodName,summarySpec,"treeCovP")).then().catch(console.error);
  
  
  // this function creates a summary spec from a template that is customized with the data and neighborhood
  function buildSummarySpec(neighborhood,spec,dataSlug) {
        // make a copy of the vega-lite spec
        var temp = JSON.parse(JSON.stringify(spec));
        // graft the neighborhood on to the specification for the color-coding
        temp.encoding.color.condition.test = "datum.Neighborhood=='"+neighborhood+"'";
        // graft the data file path on to the specification for the indicator
        temp.data.url = indicatorDataPath+dataSlug+".csv"; //note the function needs access to the indicatorDataPath global var
        // return the vega-lite spec
        return temp;
  };

  // vegaEmbed documentation available at https://github.com/vega/vega-embed

</script>



</body>
</html>